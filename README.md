# Malware-Analysis-using-Wireshark

## Summary
This project focuses on analyzing network traffic generated by malware using Wireshark. The aim is to identify malicious patterns, detect anomalies, and understand the behavior of malware through packets inspection. By capturing and dissecting network traffic, this project highlights various techniques malware uses to communicate, exfiltrate data, or spread across networks.

## Key Objectives
- Capture network traffic associated with malware execution.
- Identify suspicious communication patterens (unusual protocols, port usage, etc)
### DNS Filter
![01](https://github.com/user-attachments/assets/35317cc3-cf72-41d1-8641-402ca454fd96)

When analyzing malware, looking at DNS traffic is crucial step because it can reveal what domains the malware is attempting to contact. In this case we find alot of "No such name" this message indicates that a DNS query was made, but the requested domain does not exist or is unreachable. 
Malware often tries to contact multiple domains.
Something interesting we find is a "wtfmyip.com" a public IP lookup service. An end user wont often do that but the reason a malware would is to identify the public IP address of the infected machine for reporting back to a C2 server or determine its geographical location. 
So already the combination of failed DNS queries and a successful lookup to wftmyip.com suggests the malware might be tying to figure out its external network position before continuing with further malicious actions.
### HTTP Request/Replies
![02 1](https://github.com/user-attachments/assets/4ae607cf-8325-4435-8f14-2d552be39d38)

Usually when you browse the web is done over a secure web port 443 not port 80. There might be a few applications that use 80 but malware often uses port 80 because unencrypted traffic is easier to inspect also attackers may rely on it when trying to mimic legitmate HTTP traffic, possibly to avoid detection. 

![04](https://github.com/user-attachments/assets/5481875a-8c24-46be-88a0-909ab007c0f0)

We'll right click on the first one go to follow and then tcp stream. The first thing to notice is the user agent is coming from curl and not using a standard user agent like chrome, firefox or mozilla where there would be a long user agent string but this one is short. User agents is where it introduces itself to the server and establishing some parameters. 
We also see the servers name is cowboy and all it returns is an ip address. Let do a search to see if we talk to that address. 
![05](https://github.com/user-attachments/assets/1ea39d33-ed2f-4f41-a4b6-37d0903478b5)
We dont see this address being used. Lets leave that to the side for now.

With HTTP we can either GET traffic or POST traffic. We looked at the first one which is GET now we'll take a look at the POST traffics as there are a few.
![06](https://github.com/user-attachments/assets/35e62dc2-70af-4fd0-8483-bcfd6a326da7)

